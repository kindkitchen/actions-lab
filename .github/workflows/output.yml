name: Generate ouput in job

on:
  push:
  workflow_dispatch:

jobs:
  compute_dotenv_content:
    environment: lab
    runs-on: ubuntu-latest
    # outputs:
    #   dotenv_content: ${{ steps.step1.outputs.FOO }}
    steps:
     - name: Prepare .env to pass via input.DOTENV_CONTENT
       env:
        SECRET_CONTENT: ${{ toJson(secrets) }}
        VARS_CONTENT: ${{ toJson(vars) }}
       run: |
        echo $CONTENT > content.json 
        cat content.json | jq -r 'to_entries | map(select(.key | test("[A-Z_]+"))) | from_entries | .[] | "\(.key)=\(.value)"' > output.txt
        cat output.txt
